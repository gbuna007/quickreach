<div class="trigger-form p-5" data-controller="trigger-form">

  <%= simple_form_for trigger, data: {controller: "filter-contacts"} do |form| %>
    <div>
      <%= form.input :name, label: "Trigger Name" %>
    </div>
    <div>
      <%= form.association :account, collection: policy_scope(Account), prompt:"Choose account", input_html: {data: {action: "change->filter-contacts#select", filter_contacts_target: "selection"}}, hint: 'You can select email recipient contact after account selection.' %>
    </div>
    <div class="contact-section">
     <% label_method = proc { |p| "#{p.first_name} #{p.last_name} - #{p.title}" } %>
      <%= form.association :contact, input_html: {data: {filter_contacts_target: "contact"} }, wrapper_html: {data: {filter_contacts_target: "contactform"}, class: 'd-none'}, label_method: label_method, prompt:"Choose the email recipient" %>

      <%= form.association :template, prompt:"Choose the email template" %>
    </div>

    <%= link_to_add_nested(form, :keywords, '#keywords', link_classes:'m-0') do %>
      <button class="qt-btn mb-3">Click to add a new keyword</button>
    <% end %>
    <div id='keywords'>
      <%= form.fields_for :keywords do |keywords_f| %>
        <%= render 'keyword_fields', form: keywords_f %>
      <% end %>
    </div>

    <br>

    <%= form.submit class: 'qt-btn' %>
  <% end %>

</div>
